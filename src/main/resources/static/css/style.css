*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg-base:#0d1117;--bg-surface:#161b22;--bg-elevated:#1c2129;--bg-hover:#21262d;
  --border:#30363d;--border-subtle:#21262d;
  --text-primary:#e6edf3;--text-secondary:#8b949e;--text-muted:#484f58;
  --accent-1:#58a6ff;--accent-2:#f0883e;--accent-3:#f778ba;--accent-4:#7ee787;--accent-5:#d2a8ff;
  --red:#f85149;--green:#3fb950;
  --font-ui:'DM Sans',system-ui,sans-serif;
  --font-mono:'JetBrains Mono',monospace;
  --radius:6px;--radius-lg:10px;
  --ease:cubic-bezier(.4,0,.2,1);
}
html{font-size:14px}
body{font-family:var(--font-ui);background:var(--bg-base);color:var(--text-primary);min-height:100vh;overflow-x:hidden}
input,select,button{font-family:inherit;font-size:inherit;color:inherit}
::selection{background:var(--accent-1);color:var(--bg-base)}

/* layout */
.app{max-width:1320px;margin:0 auto;padding:24px 28px 48px}
header{display:flex;align-items:center;gap:14px;margin-bottom:28px;padding-bottom:18px;border-bottom:1px solid var(--border-subtle)}
.logo{font-family:var(--font-mono);font-weight:700;font-size:1.35rem;letter-spacing:-.02em;color:var(--text-primary)}
.logo span{color:var(--accent-1)}
header p{color:var(--text-muted);font-size:.85rem;margin-left:auto}

/* config panel */
.config-panel{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px 24px;margin-bottom:24px}
.config-panel h2{font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-muted);margin-bottom:16px}
.backtest-slots{display:flex;flex-direction:column;gap:12px}
.slot{display:grid;grid-template-columns:auto 1fr;gap:10px 16px;align-items:center;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius);padding:14px 18px;position:relative;animation:slot-in .25s var(--ease) both}
@keyframes slot-in{from{opacity:0;transform:translateY(8px)}}
.slot-color{width:10px;height:10px;border-radius:50%;grid-row:1/3}
.slot-fields{display:flex;flex-wrap:wrap;gap:8px;align-items:end}
.field{display:flex;flex-direction:column;gap:3px}
.field label{font-size:.7rem;font-weight:500;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted)}
.field input,.field select{background:var(--bg-base);border:1px solid var(--border);border-radius:4px;padding:6px 10px;color:var(--text-primary);font-family:var(--font-mono);font-size:.82rem;transition:border-color .15s}
.field input:focus,.field select:focus{outline:none;border-color:var(--accent-1)}
.field input{width:120px}
.field input.w-sm{width:90px}
.field select{width:240px;cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%238b949e' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 8px center;padding-right:28px}
.strategy-params{display:flex;gap:8px;flex-wrap:wrap;grid-column:2;margin-top:4px;padding:10px 14px;background:var(--bg-base);border:1px solid var(--border-subtle);border-radius:4px}
.strategy-params:empty{display:none}
.strategy-params-label{font-size:.65rem;font-weight:600;text-transform:uppercase;letter-spacing:.07em;color:var(--text-muted);margin-right:6px;align-self:center}
.slot-remove{position:absolute;top:8px;right:10px;background:none;border:none;color:var(--text-muted);cursor:pointer;font-size:1.1rem;line-height:1;padding:2px 6px;border-radius:3px;transition:all .15s}
.slot-remove:hover{color:var(--red);background:rgba(248,81,73,.1)}

.config-actions{display:flex;gap:10px;margin-top:16px;align-items:center}
.btn{padding:8px 18px;border-radius:var(--radius);border:1px solid var(--border);font-weight:600;font-size:.82rem;cursor:pointer;transition:all .15s var(--ease);display:inline-flex;align-items:center;gap:6px}
.btn-primary{background:var(--accent-1);border-color:var(--accent-1);color:var(--bg-base)}
.btn-primary:hover{background:#79bdff;border-color:#79bdff}
.btn-primary:active{transform:scale(.97)}
.btn-primary:disabled{opacity:.4;cursor:not-allowed;transform:none}
.btn-ghost{background:transparent;color:var(--text-secondary)}
.btn-ghost:hover{background:var(--bg-hover);color:var(--text-primary)}
.run-status{font-size:.8rem;color:var(--text-muted);font-family:var(--font-mono)}
.run-status.error{color:var(--red)}
.spinner{width:14px;height:14px;border:2px solid var(--bg-base);border-top-color:transparent;border-radius:50%;animation:spin .6s linear infinite;display:inline-block}
@keyframes spin{to{transform:rotate(360deg)}}

/* results */
.results{display:none;animation:fade-in .3s var(--ease) both}
.results.visible{display:block}
@keyframes fade-in{from{opacity:0;transform:translateY(12px)}}

.tabs{display:flex;gap:0;border-bottom:1px solid var(--border);margin-bottom:0}
.tab{padding:10px 20px;font-size:.82rem;font-weight:600;color:var(--text-muted);cursor:pointer;border-bottom:2px solid transparent;transition:all .15s;user-select:none}
.tab:hover{color:var(--text-secondary)}
.tab.active{color:var(--accent-1);border-bottom-color:var(--accent-1)}
.tab-content{display:none;padding:20px 0}
.tab-content.active{display:block;animation:fade-in .2s var(--ease) both}

/* chart */
.chart-wrap{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:20px;position:relative}
.chart-legend{display:flex;gap:18px;flex-wrap:wrap;margin-bottom:14px}
.legend-item{display:flex;align-items:center;gap:6px;font-size:.78rem;font-family:var(--font-mono);color:var(--text-secondary)}
.legend-swatch{width:12px;height:3px;border-radius:2px}
canvas{width:100%;display:block;border-radius:4px}
.chart-tooltip{position:absolute;background:var(--bg-elevated);border:1px solid var(--border);border-radius:var(--radius);padding:8px 12px;font-family:var(--font-mono);font-size:.75rem;pointer-events:none;opacity:0;transition:opacity .1s;z-index:10;white-space:nowrap}
.chart-tooltip.visible{opacity:1}

/* metrics */
.metrics-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px}
.metric-card{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius);padding:16px;display:flex;flex-direction:column;gap:14px}
.metric-card h3{font-size:.78rem;font-weight:600;display:flex;align-items:center;gap:8px}
.metric-card h3 .dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.metric-rows{display:flex;flex-direction:column;gap:6px}
.metric-row{display:flex;justify-content:space-between;align-items:baseline}
.metric-label{font-size:.75rem;color:var(--text-muted)}
.metric-value{font-family:var(--font-mono);font-size:.85rem;font-weight:600}
.metric-value.positive{color:var(--green)}
.metric-value.negative{color:var(--red)}

/* trades */
.trades-section{display:flex;flex-direction:column;gap:16px}
.trades-strategy{background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);overflow:hidden}
.trades-strategy-header{padding:12px 18px;border-bottom:1px solid var(--border-subtle);font-size:.78rem;font-weight:600;display:flex;align-items:center;gap:8px;cursor:pointer;user-select:none;transition:background .15s}
.trades-strategy-header:hover{background:var(--bg-hover)}
.trades-strategy-header .dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.trades-strategy-header .chevron{margin-left:auto;transition:transform .2s var(--ease);color:var(--text-muted);font-size:.7rem}
.trades-strategy.collapsed .chevron{transform:rotate(-90deg)}
.trades-strategy.collapsed .trades-body{display:none}
.trades-strategy.collapsed .trades-strategy-header{border-bottom-color:transparent}
table{width:100%;border-collapse:collapse;font-size:.8rem}
thead th{text-align:left;padding:8px 14px;font-size:.7rem;font-weight:600;text-transform:uppercase;letter-spacing:.06em;color:var(--text-muted);border-bottom:1px solid var(--border-subtle)}
tbody td{padding:7px 14px;border-bottom:1px solid var(--border-subtle);font-family:var(--font-mono);font-size:.78rem}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover{background:var(--bg-hover)}
td.action-buy{color:var(--green)}
td.action-sell{color:var(--red)}
td.reason{font-family:var(--font-ui);color:var(--text-secondary);max-width:260px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

/* scrollbar */
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:var(--bg-base)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}

/* responsive */
@media(max-width:768px){
  .app{padding:16px}
  .slot-fields{flex-direction:column}
  .field input,.field select{width:100%}
  .metrics-grid{grid-template-columns:1fr}
}
